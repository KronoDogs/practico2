frq(proc_data$afav.venz)
frq(proc_data$clasesocial)
proc_data$conf.md <- set_labels(proc_data$conf.md,
labels=c("Ninguna"=0,
"Poca"=1,
"Algo"=2,
"Mucha"=3))
proc_data$afav.latin <- set_labels(proc_data$afav.latin,
labels=c("Muy en desacuerdo"=0,
"En desacuerdo"=1,
"De Acuerdo"=2,
"Muy de acuerdo"=3))
proc_data$afav.venz <- set_labels(proc_data$afav.venz,
labels=c("Muy en desacuerdo"=0,
"En desacuerdo"=1,
"De Acuerdo"=2,
"Muy de acuerdo"=3))
proc_data$afav.hait <- set_labels(proc_data$afav.hait,
labels=c("Muy en desacuerdo"=0,
"En desacuerdo"=1,
"De Acuerdo"=2,
"Muy de acuerdo"=3))
proc_data$clasesocial <- set_labels(proc_data$clasesocial,
labels=c("Alta"=5,
"Media alta"=4,
"Media"=3,
"Media baja"=2,
"Baja"=1))
proc_data$p39st_b <- recode(proc_data$p39st_b, "c(-5,-4,-3,-2,-1)=NA")
proc_data$p39st_b <- recode(proc_data$p39st_b, "1=3; 2=2; 3=1; 4=0")
proc_data <- proc_data %>% rename("in.trabajo"=p39st_b)
proc_data$in.trabajo <- set_label(x = proc_data$in.trabajo,label = "Inmigrantes quitan trabajo")
get_label(proc_data$in.trabajo)
proc_data$in.trabajo <- set_labels(proc_data$in.trabajo,
labels=c("Muy en desacuerdo"=0,
"En desacuerdo"=1,
"De Acuerdo"=2,
"Muy de acuerdo"=3))
frq(proc_data$in.crimen)
frq(proc_data$in.crimen)
proc_data$p39n_c <- recode(proc_data$p39n_c, "c(-5,-4,-3,-2,-1)=NA")
proc_data$p39n_c <- recode(proc_data$p39n_c, "1=3; 2=2; 3=1; 4=0")
proc_data <- proc_data %>% rename("in.crimen"=p39n_c)
proc_data$in.crimen <- set_label(x = proc_data$in.crimen,label = "Inmigrantes aumentan el crimen")
get_label(proc_data$in.crimen)
proc_data$in.crimen <- set_labels(proc_data$in.crimen,
labels=c("Muy en desacuerdo"=0,
"En desacuerdo"=1,
"De Acuerdo"=2,
"Muy de acuerdo"=3))
proc_data$p39n_e <- recode(proc_data$p39n_e, "c(-5,-4,-3,-2,-1)=NA")
proc_data$p39n_e <- recode(proc_data$p39n_e, "1=3; 2=2; 3=1; 4=0")
proc_data <- proc_data %>% rename("in.carga"=p39n_e)
proc_data$in.carga <- set_label(x = proc_data$in.carga,label = "Inmigrantes son una carga para el Estado")
get_label(proc_data$in.carga)
proc_data$in.carga <- set_labels(proc_data$in.carga,
labels=c("Muy en desacuerdo"=0,
"En desacuerdo"=1,
"De Acuerdo"=2,
"Muy de acuerdo"=3))
#recodificacion para la variable de sexo
proc_data$sexo <- car::recode(proc_data$sexo, "1=0;2=1")
proc_data$sexo <- factor(proc_data$sexo,
labels=c( "Hombre",
"Mujer"),
levels=c(0,1))
get_label(proc_data$sexo)
proc_data$sexo <- set_label(x = proc_data$sexo,label = "Sexo")
frq(proc_data$sexo)
get_label(proc_data$edad)
proc_data$edad <- set_label(x = proc_data$edad,label = "Edad")
proc_data <- as.data.frame(proc_data)
stargazer(proc_data, type ="text")
proc_data %>% dplyr::group_by(sexo) %>% summarise(mean(afav.latin, na.rm=TRUE))
proc_data %>% dplyr::group_by(sexo) %>% summarise(mean(afav.venz, na.rm=TRUE))
proc_data %>% dplyr::group_by(sexo) %>% summarise(mean(conf.md, na.rm=TRUE))
proc_data %>% dplyr::group_by(clasesocial) %>% summarise(mean(conf.md, na.rm=TRUE))
#instalamos sjplot para la representación, segun clase social: conf.md - afav.latin - afav.venz (output carpet)
#Representacion de tablas descriptivas para las variables
library(sjPlot)
sjt.xtab(proc_data$clasesocial, proc_data$conf.md, encoding = "UTF-12")
sjt.xtab(proc_data$clasesocial, proc_data$afav.latin, encoding = "UTF-12")
sjt.xtab(proc_data$clasesocial, proc_data$afav.venz, encoding = "UTF-12")
sjt.xtab(proc_data$sexo, proc_data$conf.md, encoding = "UTF-12")
sjt.xtab(proc_data$sexo, proc_data$afav.latin, encoding = "UTF-12")
sjt.xtab(proc_data$sexo, proc_data$afav.venz, encoding = "UTF-12")
# Formatear la tabla con kableExtra
tabla_mtc<- tabla_descriptiva %>%
kbl() %>%
kable_styling(full_width = FALSE) %>%
row_spec(0, bold = TRUE)
# Mostrar la tabla en el Viewer de RStudio
tabla_mtc
#Librerias para graficos y tablas
pacman::p_load(sjlabelled,
dplyr,
stargazer,
sjmisc,
summarytools,
kableExtra,
sjPlot,
corrplot,
sessioninfo,
ggplot2,
haven,
tidyverse)
proc_data <-na.omit(proc_data) #Borramos casos perdidos ya que no bajan tanto
ggplot(proc_data, aes(x = conf.md))
proc_data %>% ggplot(aes(x = conf.md)) + geom_bar()
proc_data %>% ggplot(aes(x = conf.md)) + geom_bar(fill="purple")
proc_data %>% ggplot(aes(x = afav.latin)) + geom_bar(fill="purple")
proc_data %>% ggplot(aes(x = afav.venz)) + geom_bar(fill="purple")
proc_data %>% ggplot(aes(x = clasesocial)) + geom_bar(fill="purple")
#grafico a favor de la inmigracion en Chile: Este se utilizó para Quarto
graf.in <- sjPlot::plot_stackfrq(dplyr:: select(proc_data, afav.venz,
afav.latin),
title= "A favor de la inmigración: Chile") +
theme(legend.position="bottom")
graf.in
graf.conf.md <- sjPlot::plot_stackfrq(dplyr:: select(proc_data,conf.md),
title= "Confianza en los medios de comunicación") +
theme(legend.position="bottom")
graf.conf.md
#=============
ggsave(graf.in, file="output/graficoinmigracion.pdf")
ggsave(graf.conf.md, file="output/graficomedios.pdf")
graf.insex <- proc_data %>% ggplot(aes(x = conf.md, fill = sexo)) +
geom_bar() +
xlab("Confianza en los medios de comunicación") +
ylab("Cantidad") +
labs(fill="Sexo")+
scale_fill_discrete(labels = c('Hombre','Mujer'))
proc_data %>% ggplot(aes(x = afav.latin)) +
geom_bar() +
xlab("A favor de la inmigración latina") +
ylab("Cantidad")+
facet_wrap(~clasesocial)
pacman::p_load(dplyr, # Manipulacion datos
sjmisc, # Descriptivos
sjPlot, # Tablas
sjlabelled, #etiquetas
kableExtra, #Tablas
GGally, # Correlaciones
corrplot) # Correlaciones
class(proc_data$conf.md)
class(proc_data$in.carga)
#forzar a la base que todas sus variables sean de tipo numérica
basecor <- proc_data %>% mutate_all(~(as.numeric(.)))
Mcor <- cor(basecor, use = "complete.obs")
corrplot.mixed(Mcor)
Mcor2 <- cor(dplyr::select(basecor,conf.md, afav.latin, afav.hait, afav.venz,
in.trabajo, in.crimen, in.carga))
corrplot.mixed(Mcor2)
#Indice ponderado.
#Pesos para las variables en c(
afavlatin <- basecor$afav.latin
afavvenz <- basecor$afav.venz
afavhait <- basecor$afav.hait
pesosvar <- c(0.30, 0.40, 0.30)
indicexen1 <- (afavlatin * pesosvar[1] + afavvenz * pesosvar[2] + afavhait * pesosvar[3])
basecor$indicexen1 <- indicexen1
basecor2 <- basecor %>% select(afav.latin, afav.venz, afav.hait, in.trabajo, in.crimen, in.carga, conf.md)
basecor2 <- basecor2 %>%
rowwise() %>%
mutate(afav.venz = sum(c(afav.hait, afav.latin), na.rm = TRUE))
ggpairs(basecor2)
hist(basecor$indicexen,
main = "Histograma de Índice de Xenofobia en Chile",
xlab = "Índice de Xenofobia",
ylab = "Frecuencia",
col = "purple",
border = "yellow",
breaks = 10
)
lastbase <- latinobarometro2020 %>% select(p15st_d, # Medios de comunicacion
p37n_b, # A favor de recibir Inmigrantes Latinos
p37n_d, # A favor de recibir Inmigrantes venezolanos
s1, # Clase social
sexo, # sexo
edad, #edad
idenpa, # pais
p37n_c, # A favor de recibir Inmigrantes haitianos
p39st_b, # Indice negativo inmigracion: trabajo
p39n_c, # Indice negativo inmigracion: crimen
p39n_e, # Indice negativo inmigracion: carga E
s16,
p18st) # Nivel educacional alcanzado
lastbase <- lastbase %>% dplyr::filter(idenpa==152)
lastbase$p15st_d <- recode(lastbase$p15st_d, "c(-5,-4,-3,-2,-1)=NA")
lastbase$p37n_b <- recode(lastbase$p37n_b, "c(-5,-4,-3,-2,-1)=NA")
lastbase$p37n_d <- recode(lastbase$p37n_d, "c(-5,-4,-3,-2,-1,9)=NA")
lastbase$p37n_c <- recode(lastbase$p37n_c, "c(-5,-4,-3,-2,-1,0)=NA")
lastbase$s1 <- recode(lastbase$s1, "c(-5,-4,-3,-2,-1)=NA")
lastbase$p15st_d <- recode(lastbase$p15st_d, "1=3; 2=2; 3=1; 4=0")
lastbase$p37n_b <- recode(lastbase$p37n_b, "1=3; 2=2; 3=1; 4=0")
lastbase$p37n_d <- recode(lastbase$p37n_d, "1=3; 2=2; 3=1; 4=0")
lastbase$p37n_c <- recode(lastbase$p37n_c, "1=3; 2=2; 3=1; 4=0")
lastbase$s1 <- recode(lastbase$s1, "1=5; 2=4; 3=3; 4=2; 5=1")
lastbase <- lastbase %>% rename("conf.md"=p15st_d, # Confianza en los medios de comunicacion
"afav.latin"=p37n_b, # A favor de la inmigracion latina
"afav.venz"=p37n_d, # A favor de la inmigracion venezolana
"clasesocial"=s1, # Clase social
"afav.hait"=p37n_c) # A favor de la inmigración hatiana
lastbase$conf.md <- set_label(x = lastbase$conf.md,label = "Confianza en Medios")
get_label(lastbase$conf.md)
lastbase$afav.latin <- set_label(x = lastbase$afav.latin,label = "A favor: Latinos")
get_label(lastbase$afav.latin)
lastbase$afav.venz <- set_label(x = lastbase$afav.venz,label = "A favor: Venezolanos")
get_label(lastbase$afav.venz)
lastbase$clasesocial <- set_label(x = lastbase$clasesocial,label = "Clase Social")
get_label(lastbase$clasesocial)
lastbase$afav.hait <- set_label(x = lastbase$afav.hait,label = "A favor: Haitianos")
get_label(lastbase$afav.hait)
lastbase$conf.md <- set_labels(lastbase$conf.md,
labels=c("Ninguna"=3,
"Poca"=2,
"Algo"=1,
"Mucha"=0))
lastbase$afav.latin <- set_labels(lastbase$afav.latin,
labels=c("Muy en desacuerdo"=3,
"En desacuerdo"=2,
"De Acuerdo"=1,
"Muy de acuerdo"=0))
lastbase$afav.venz <- set_labels(lastbase$afav.venz,
labels=c("Muy en desacuerdo"=3,
"En desacuerdo"=2,
"De Acuerdo"=1,
"Muy de acuerdo"=0))
lastbase$afav.hait <- set_labels(lastbase$afav.hait,
labels=c("Muy en desacuerdo"=3,
"En desacuerdo"=2,
"De Acuerdo"=1,
"Muy de acuerdo"=0))
lastbase$clasesocial <- set_labels(lastbase$clasesocial,
labels=c("Alta"=5,
"Media alta"=4,
"Media"=3,
"Media baja"=2,
"Baja"=1))
lastbase$p39st_b <- recode(lastbase$p39st_b, "c(-5,-4,-3,-2,-1)=NA")
lastbase$p39st_b <- recode(lastbase$p39st_b, "1=3; 2=2; 3=1; 4=0")
lastbase <- lastbase %>% rename("in.trabajo"=p39st_b)
lastbase$in.trabajo <- set_label(x = lastbase$in.trabajo,label = "Inmigrantes quitan trabajo")
get_label(lastbase$in.trabajo)
lastbase$in.trabajo <- set_labels(lastbase$in.trabajo,
labels=c("Muy en desacuerdo"=0,
"En desacuerdo"=1,
"De Acuerdo"=2,
"Muy de acuerdo"=3))
lastbase$in.crimen <- recode(lastbase$p39n_c, "c(-5,-4,-3,-2,-1)=NA")
lastbase$in.crimen <- recode(lastbase$in.crimen, "1=3; 2=2; 3=1; 4=0")
lastbase$in.crimen <- set_label(x = lastbase$in.crimen,label = "Inmigrantes aumentan el crimen")
get_label(lastbase$in.crimen)
lastbase$in.crimen <- set_labels(lastbase$in.crimen,
labels=c("Muy en desacuerdo"=0,
"En desacuerdo"=1,
"De Acuerdo"=2,
"Muy de acuerdo"=3))
lastbase$in.carga <- recode(lastbase$p39n_e, "c(-5,-4,-3,-2,-1)=NA")
lastbase$in.carga <- recode(lastbase$in.carga, "1=3; 2=2; 3=1; 4=0")
lastbase$in.carga <- set_label(x = lastbase$in.carga,label = "Inmigrantes son una carga para el Estado")
get_label(lastbase$in.carga)
lastbase$in.carga <- set_labels(lastbase$in.carga,
labels=c("Muy en desacuerdo"=0,
"En desacuerdo"=1,
"De Acuerdo"=2,
"Muy de acuerdo"=3))
#Indice ponderado.
#Pesos para las variables en c(
afavlatin <- lastbase$afav.latin
afavvenz <- lastbase$afav.venz
afavhait <- lastbase$afav.hait
intrabajo <- lastbase$in.trabajo
incarga <- lastbase$in.carga
incrimen <- lastbase$in.crimen
pesosvar <- c(0.18, 0.20, 0.18, 0.18, 0.20, 0.18)
indicexen1 <- (afavlatin * pesosvar[1] + afavvenz * pesosvar[2] + afavhait * pesosvar[3] + intrabajo * pesosvar[4] + incarga * pesosvar[5] + incrimen * pesosvar[6])
lastbase$indicexen1 <- indicexen1
pacman::p_load(dplyr, car, sjmisc, sjPlot, sjlabelled, stargazer, kableExtra, corrplot, texreg, ggplot2, ggpubr)
lastbase <- na.omit(lastbase) #abse lista para los modelos de regresión
regresion1 <- lm(indicexen1 ~ conf.md, data=lastbase)
stargazer(regresion1, type = "text")
regresion2 <- lm(indicexen1 ~ edad, data=lastbase)
stargazer(regresion2, type = "text")
regresion3 <- lm(indicexen1 ~ clasesocial, data=lastbase)
stargazer(regresion3, type = "text")
knitreg(list(regresion1, regresion2, regresion3),
custom.model.names = c("Modelo 1",
"Modelo 2",
"Modelo 3"),
custom.note = "*** p < 0.001; ** p < 0.01; * p < 0.05",
custom.coef.names = c("Intercepto",
"confianza en los medios",
"Edad",
"clase social"),
caption = "Xenofobia",
caption.above = TRUE)
# Recode the variable s6 in the lastbase dataset
lastbase$Educacion <- cut(lastbase$s16,
breaks = c(0, 1, 8, 12, 13, 14, 15, 16, 17),
labels = c("Sin estudios", "Nivel básico", "Nivel Medio", "Nivel Medio",
"Universitario incompleto", "Universitario Completo",
"Institutos incompletos", "Institutos completos"),
right = FALSE)
# Convert to factor to ensure it is categorical
lastbase$Educacion <- factor(lastbase$Educacion,
levels = c("Sin estudios", "Nivel básico", "Nivel Medio",
"Universitario incompleto", "Universitario Completo",
"Institutos incompletos", "Institutos completos"))
stargazer(regresion1, type = "text")
regresion2 <- lm(indicexen1 ~ edad, data=lastbase)
stargazer(regresion2, type = "text")
knitreg(list(regresion1, regresion2, regresion3),
custom.model.names = c("Modelo 1",
"Modelo 2",
"Modelo 3"),
custom.note = "*** p < 0.001; ** p < 0.01; * p < 0.05",
custom.coef.names = c("Intercepto",
"confianza en los medios",
"Edad",
"clase social"),
caption = "Xenofobia",
caption.above = TRUE)
View(lastbase)
regresion4 <- lm(indicexen1 ~ conf.md + edad + clasesocial, data=lastbase)
stargazer(regresion4, type = "text")
regresion5 <- lm(indicexen1 ~ conf.md + edad + Educacion, data=lastbase)
stargazer(regresion5, type = "text")
stargazer(regresion4, type = "text")
lastbase <-na.omit(lastbase)
regresion1 <- lm(indicexen1 ~ conf.md, data=lastbase)
stargazer(regresion1, type = "text")
regresion2 <- lm(indicexen1 ~ edad, data=lastbase)
stargazer(regresion2, type = "text")
regresion3 <- lm(indicexen1 ~ clasesocial, data=lastbase)
stargazer(regresion3, type = "text")
knitreg(list(regresion1, regresion2, regresion3),
custom.model.names = c("Modelo 1",
"Modelo 2",
"Modelo 3"),
custom.note = "*** p < 0.001; ** p < 0.01; * p < 0.05",
custom.coef.names = c("Intercepto",
"confianza en los medios",
"Edad",
"clase social"),
caption = "Xenofobia",
caption.above = TRUE)
regresion1 <- lm(indicexen1 ~ conf.md, data=lastbase)
stargazer(regresion1, type = "text")
regresion2 <- lm(indicexen1 ~ edad, data=lastbase)
stargazer(regresion2, type = "text")
regresion3 <- lm(indicexen1 ~ clasesocial, data=lastbase)
stargazer(regresion3, type = "text")
knitreg(list(regresion1, regresion2, regresion3),
custom.model.names = c("Modelo 1",
"Modelo 2",
"Modelo 3"),
custom.note = "*** p < 0.001; ** p < 0.01; * p < 0.05",
custom.coef.names = c("Intercepto",
"confianza en los medios",
"Edad",
"clase social"),
caption = "Xenofobia",
caption.above = TRUE)
regresion6 <- lm(indicexen1 ~ Educacion, data = lastbase)
stargazer(regresion6, type = "text")
#poner en quarto
knitreg(list(regresion1, regresion6, regresion3),
custom.model.names = c("Modelo 1",
"Modelo 2",
"Modelo 3"),
custom.note = "*** p < 0.001; ** p < 0.01; * p < 0.05",
custom.coef.names = c("Intercepto",
"confianza en los medios",
"Edad",
"clase social"),
caption = "Xenofobia",
caption.above = TRUE)
#poner en quarto
knitreg(list(regresion1, regresion6, regresion3),
custom.model.names = c("Modelo 1",
"Modelo 2",
"Modelo 3"),
custom.note = "*** p < 0.001; ** p < 0.01; * p < 0.05",
custom.coef.names = c("Intercepto",
"confianza en los medios",
"Edad",
"clase social"),
caption = "Xenofobia",
caption.above = TRUE)
regresion6 <- lm(indicexen1 ~ Educacion, data = lastbase)
stargazer(regresion6, type = "text")
stargazer(regresion5, type = "text")
regresion5 <- lm(indicexen1 ~ conf.md + clasesocial + Educacion, data=lastbase)
stargazer(regresion5, type = "text")
#| warning: false
#| echo: false
pacman::p_load(sjmisc, car, sjlabelled, haven)
pacman::p_load(sjlabelled,
dplyr,
stargazer,
summarytools,
kableExtra,
sjPlot,
corrplot,
sessioninfo,
ggplot2,
tidyverse,
xfun)
#| warning: false
#| echo: false
load("input/data/proc_data.RData")
#Tabla descriptiva de las medidas de tendencia central
# Calcular la moda
get_mode <- function(x) {
ux <- unique(x)
ux[which.max(tabulate(match(x, ux)))]
}
# Calcular las medidas de tendencia central
media <- c(mean(proc_data$clasesocial), mean(proc_data$afav.venz), mean(proc_data$afav.latin), mean(proc_data$conf.md))
mediana <- c(median(proc_data$clasesocial), median(proc_data$afav.venz), median(proc_data$afav.latin), median(proc_data$conf.md))
moda <- c(get_mode(proc_data$clasesocial), get_mode(proc_data$afav.venz), get_mode(proc_data$afav.latin), get_mode(proc_data$conf.md))
# Crear la tabla descriptiva
tabla_descriptiva <- data.frame(
Variable = c("Clase Social", "afav.venz", "afav.latin", "conf.md"),
Media = media,
Mediana = mediana,
Moda = moda
)
# Formatear la tabla con kableExtra
tabla_mtc<- tabla_descriptiva %>%
kbl() %>%
kable_styling(full_width = FALSE) %>%
row_spec(0, bold = TRUE)
# Mostrar la tabla en el Viewer de RStudio
tabla_mtc
#| warning: false
#| echo: false
frq(proc_data$conf.md)
#| warning: false
#| echo: false
frq(proc_data$afav.latin)
#| warning: false
#| echo: false
frq(proc_data$afav.venz)
#| warning: false
#| echo: false
graf.in <- sjPlot::plot_stackfrq(dplyr:: select(proc_data, afav.venz,
afav.latin),
title= "A favor de la inmigración: Chile") +
theme(legend.position="bottom")
graf.in
#| warning: false
#| echo: false
proc_data %>% ggplot(aes(x = afav.latin)) +
geom_bar() +
xlab("A favor de la inmigración latina") +
ylab("Cantidad")+
facet_wrap(~conf.md)
#| warning: false
#| echo: false
proc_data %>% ggplot(aes(x = afav.venz)) +
geom_bar() +
xlab("A favor de la inmigración latina") +
ylab("Cantidad")+
facet_wrap(~conf.md)
#| warning: false
#| echo: false
load("input/data/basecor.RData")
library(GGally)
#| warning: false
#| echo: false
Mcor2 <- cor(dplyr::select(basecor,conf.md, afav.latin, afav.hait, afav.venz,
in.trabajo, in.crimen, in.carga))
corrplot.mixed(Mcor2)
#| warning: false
#| echo: false
basecor2 <- basecor %>% select(afav.latin, afav.venz, afav.hait, in.trabajo, in.crimen, in.carga, conf.md)
#| warning: false
#| echo: false
basecorOFICIAL <- basecor2 %>%
rowwise() %>%
mutate(afav.venz = sum(c(afav.hait, afav.latin), na.rm = TRUE))
ggpairs(basecor2)
#| warning: false
#| echo: false
summary(basecor$indicexen1)
summary(basecor$indicexen2)
#| warning: false
#| echo: false
summary(basecor$indicexen1)
plot_model(regresion5,
title = "", #quitar titulo
show.values = TRUE, #mostrar valor de efectos
dot.size = 3, #tamaño circulos
line.size = 1, #tamaño CI
value.size = 4, #tamaño valor efectoss
spacing = 1, #espacio entre efectos
vline.color = "red", # linea roja en punto neutro (0)
axis.labels = rev(c("Edad",
"Educación media",
"Educación superior", )),
show.legend = FALSE) + # variables dependientes
theme_bw()
plot_model(regresion5,
title = "", #quitar titulo
show.values = TRUE, #mostrar valor de efectos
dot.size = 3, #tamaño circulos
line.size = 1, #tamaño CI
value.size = 4, #tamaño valor efectoss
spacing = 1, #espacio entre efectos
vline.color = "red")
